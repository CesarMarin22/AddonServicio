{% extends "menu.html" %} {% block title %} Gestión de Usuarios - IPL {%
endblock %} {% block content %}
<div
  class="d-flex justify-content-between align-items-center pt-3 pb-2 mb-3 border-bottom"
>
  <button
    type="button"
    class="btn btn-dark d-lg-none me-2"
    data-toggle="modal"
    data-target="#sidebarModal"
  >
    <i class="fas fa-bars"></i>
    <!-- Icono de 3 rayitas -->
  </button>
  <h1 class="h2 mb-0 flex-grow-1">Gestión de Usuarios</h1>
  <button type="button" class="btn btn-primary" onclick="createUser()">
    Crear Usuario
  </button>
</div>

<!-- Users content -->
<div id="usersContent">
  <h2>Usuarios</h2>
  <table class="table" id="usersTable">
    <thead>
      <tr>
        <th>ID</th>
        <th>Usuario</th>
        <th>Perfil</th>
        <th>Activo</th>
        <th>Socio</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for user in users %}
      <tr>
        <td>{{ user.ID }}</td>
        <td>{{ user.USUARIO }}</td>
        <td>{{ user.PERFIL }}</td>
        <td>{{ user.ACTIVO }}</td>
        <td>{{ user.SOCIO }}</td>
        <td>
          <button
            class="btn btn-warning btn-sm"
            onclick="editUser({{ user.ID }})"
          >
            Editar
          </button>
          <button
            class="btn btn-danger btn-sm"
            onclick="deleteUser({{ user.ID }})"
          >
            Eliminar
          </button>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- Modal para Crear/Editar Usuario -->
<div
  class="modal fade"
  id="userModal"
  tabindex="-1"
  aria-labelledby="userModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="userModalLabel">Crear Usuario</h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form id="userForm">
        <div class="modal-body">
          <input type="hidden" id="userId" />
          <div class="form-group">
            <label for="usuario">Usuario</label>
            <input type="text" class="form-control" id="usuario" required />
          </div>
          <div class="form-group">
            <label for="perfil">Perfil</label>
            <select class="form-control" id="perfil">
              <option value="1">Administrador</option>
              <option value="2">Supervisor</option>
              <option value="3">Empleado</option>
            </select>
          </div>
          <div class="form-group">
            <label for="activo">Activo</label>
            <select class="form-control" id="activo">
              <option value="1">Sí</option>
              <option value="0">No</option>
            </select>
          </div>
          <div class="form-group">
            <label for="socio">Socio</label>
            <select class="form-control" id="socio" required>
              <option value="">Seleccione un socio</option>
            </select>
          </div>
          <div class="form-group">
            <label for="pwd">Contraseña</label>
            <div class="input-group">
              <input type="password" class="form-control" id="pwd" required />
              <div class="input-group-append">
                <button
                  type="button"
                  class="btn btn-outline-secondary"
                  id="togglePwdVisibility"
                >
                  <i class="fas fa-eye"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">
            Cerrar
          </button>
          <button type="submit" class="btn btn-primary">Guardar</button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
<!-- Incluye axios -->
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<!-- Incluye tu script -->
<script src="{{ url_for('static', filename='js/script.js') }}"></script>
{% endblock %}
